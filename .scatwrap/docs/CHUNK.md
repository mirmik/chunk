<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>docs/CHUNK.md</title>
</head>
<body>
<!-- BEGIN SCAT CODE -->
#&nbsp;Формат&nbsp;патчей&nbsp;CHUNK<br>
<br>
Формат&nbsp;CHUNK&nbsp;задуман&nbsp;c&nbsp;тем,&nbsp;чтобы<br>
<br>
*&nbsp;быть&nbsp;достаточно&nbsp;простым&nbsp;для&nbsp;чтения&nbsp;человеком&nbsp;и&nbsp;генерации&nbsp;нейросетью;<br>
*&nbsp;и&nbsp;достаточно&nbsp;строгим,&nbsp;чтобы&nbsp;безопасно&nbsp;модифицировать&nbsp;исходный&nbsp;код.<br>
<br>
<br>
Файл&nbsp;описываем&nbsp;**формат&nbsp;файла&nbsp;и&nbsp;семантику&nbsp;команд**.<br>
CHUNK&nbsp;использует&nbsp;облегчённый&nbsp;yaml&nbsp;синтаксис&nbsp;потому&nbsp;что&nbsp;нейросети&nbsp;достаточно&nbsp;стабильно&nbsp;пишут&nbsp;yaml&nbsp;документы&nbsp;(в&nbsp;отличие&nbsp;от&nbsp;unified&nbsp;diff)<br>
##&nbsp;Комментарии&nbsp;и&nbsp;символ&nbsp;`#`<br>
Диалект&nbsp;yaml,&nbsp;который&nbsp;использует&nbsp;CHUNK,&nbsp;**не&nbsp;поддерживает&nbsp;комментарии&nbsp;YAML**.<br>
Это&nbsp;сделано&nbsp;потому,&nbsp;что&nbsp;`#`&nbsp;может&nbsp;присутствовать&nbsp;в&nbsp;python&nbsp;коде,&nbsp;в&nbsp;c++&nbsp;коде,&nbsp;а&nbsp;объяснять&nbsp;кремниевому&nbsp;мозгу,&nbsp;что&nbsp;символ&nbsp;надо&nbsp;экранировать&nbsp;-&nbsp;себе&nbsp;дороже.<br>
Поэтому&nbsp;символ&nbsp;`#`&nbsp;нигде&nbsp;не&nbsp;имеет&nbsp;специального&nbsp;смысла&nbsp;и&nbsp;всегда&nbsp;считается&nbsp;частью&nbsp;строки.&nbsp;<br>
Для&nbsp;пояснений&nbsp;к&nbsp;патчу&nbsp;в&nbsp;целом&nbsp;используйте&nbsp;поле&nbsp;`description`,&nbsp;а&nbsp;также&nbsp;поле&nbsp;`comment`&nbsp;для&nbsp;коментария&nbsp;каждой&nbsp;операций.<br>
<br>
---<br>
<br>
##&nbsp;1.&nbsp;Структура&nbsp;файла<br>
<br>
Корень&nbsp;YAML-документа&nbsp;—&nbsp;**объект**&nbsp;с&nbsp;обязательным&nbsp;полем&nbsp;`operations`:<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_text<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.py<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_py_method<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
````<br>
<br>
Также&nbsp;опционально,&nbsp;но&nbsp;весьма&nbsp;желательно&nbsp;добавить&nbsp;описание&nbsp;description&nbsp;и&nbsp;название&nbsp;языка&nbsp;программирования&nbsp;language&nbsp;(поддерживаются&nbsp;python&nbsp;и&nbsp;c++):<br>
<br>
```yaml<br>
description:&nbsp;&quot;Краткое&nbsp;описание&nbsp;патча&quot;<br>
language:&nbsp;python<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;...<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;...<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
```<br>
<br>
*&nbsp;`operations`&nbsp;—&nbsp;массив&nbsp;операций.<br>
*&nbsp;каждый&nbsp;элемент&nbsp;массива&nbsp;—&nbsp;отдельная&nbsp;операция,&nbsp;причём&nbsp;операции&nbsp;применяются&nbsp;в&nbsp;порядке&nbsp;изложения&nbsp;в&nbsp;документе.<br>
<br>
Кроме&nbsp;этого,&nbsp;у&nbsp;каждой&nbsp;операции&nbsp;можно&nbsp;задать&nbsp;необязательное&nbsp;поле&nbsp;`comment`&nbsp;с&nbsp;произвольным&nbsp;описанием:<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_text<br>
&nbsp;&nbsp;&nbsp;&nbsp;comment:&nbsp;&quot;Локальная&nbsp;заметка&nbsp;к&nbsp;операции&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;...<br>
```<br>
<br>
Поле&nbsp;`comment`&nbsp;не&nbsp;влияет&nbsp;на&nbsp;применение&nbsp;патча&nbsp;и&nbsp;служит&nbsp;только&nbsp;для&nbsp;пояснений.<br>
<br>
---<br>
<br>
##&nbsp;2.&nbsp;Маркеры,&nbsp;whitespace,&nbsp;игнорирование&nbsp;комментариев.<br>
<br>
Для&nbsp;текстовых&nbsp;команд&nbsp;используются&nbsp;поля:<br>
<br>
*&nbsp;`marker`&nbsp;—&nbsp;основной&nbsp;фрагмент&nbsp;для&nbsp;поиска;<br>
*&nbsp;`before`&nbsp;—&nbsp;контекст&nbsp;до&nbsp;маркера&nbsp;(опционально);<br>
*&nbsp;`after`&nbsp;—&nbsp;контекст&nbsp;после&nbsp;маркера&nbsp;(опционально).<br>
<br>
Последние&nbsp;две&nbsp;опциональны.&nbsp;Могут&nbsp;быть&nbsp;использованы&nbsp;для&nbsp;уточнения&nbsp;маркера,&nbsp;если&nbsp;в&nbsp;файле&nbsp;есть&nbsp;повторы.<br>
Все&nbsp;три&nbsp;поля&nbsp;—&nbsp;многострочные&nbsp;скаляры&nbsp;YAML&nbsp;(`|`&nbsp;/&nbsp;`|-`).<br>
<br>
**Поиск&nbsp;маркера:**<br>
<br>
При&nbsp;поиске&nbsp;маркера&nbsp;мы&nbsp;**игнорируем&nbsp;различия&nbsp;в&nbsp;отступах,&nbsp;хвостовых&nbsp;пробелах&nbsp;и&nbsp;количестве&nbsp;пустых&nbsp;строк**,&nbsp;чтобы&nbsp;патчи&nbsp;не&nbsp;ломались&nbsp;из-за&nbsp;форматирования&nbsp;различных&nbsp;версий&nbsp;ide&nbsp;и&nbsp;вэбпросмотрщиков,&nbsp;в&nbsp;том&nbsp;числе&nbsp;используемых&nbsp;нейросетями&nbsp;при&nbsp;просмотре&nbsp;интернет&nbsp;ссылок.&nbsp;Также&nbsp;**игнорируются&nbsp;комментарии&nbsp;на&nbsp;том&nbsp;языке&nbsp;программирования,&nbsp;что&nbsp;был&nbsp;передан&nbsp;в&nbsp;language**.&nbsp;Это&nbsp;сделано&nbsp;потому,&nbsp;что&nbsp;нейросеть&nbsp;любит&nbsp;глотать&nbsp;коментарии&nbsp;при&nbsp;переписывании&nbsp;текста&nbsp;маркера.<br>
<br>
Правила&nbsp;обработки&nbsp;маркера:<br>
*&nbsp;удаляются&nbsp;пробелы&nbsp;и&nbsp;табы&nbsp;в&nbsp;начале&nbsp;и&nbsp;в&nbsp;конце&nbsp;строки;<br>
*&nbsp;игнорируются&nbsp;пустые&nbsp;строки;<br>
*&nbsp;результирующий&nbsp;диапазон&nbsp;`[begin,&nbsp;end]`&nbsp;расчитывается&nbsp;по&nbsp;реальным&nbsp;строкам&nbsp;файла,&nbsp;включая&nbsp;выкинутые&nbsp;пустые.<br>
<br>
С&nbsp;точки&nbsp;зрения&nbsp;CHUNK&nbsp;следующие&nbsp;маркеры&nbsp;идентичны<br>
```<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A<br>
<br>
B<br>
```<br>
```<br>
A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B<br>
```<br>
поскольку&nbsp;оба&nbsp;приводятся&nbsp;к&nbsp;каноничной&nbsp;форме&nbsp;<br>
<br>
```<br>
A<br>
B<br>
```<br>
<br>
---<br>
<br>
##&nbsp;3.&nbsp;Отступы&nbsp;`payload`<br>
<br>
Отступы&nbsp;вставляемого&nbsp;текста&nbsp;по&nbsp;умолчанию&nbsp;выравниваются&nbsp;по&nbsp;идентации&nbsp;начала&nbsp;маркера,&nbsp;но&nbsp;это&nbsp;поведение&nbsp;можно&nbsp;изменить:<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_text<br>
&nbsp;&nbsp;&nbsp;&nbsp;marker:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;value()&nbsp;const;<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;value()&nbsp;const&nbsp;noexcept;<br>
&nbsp;&nbsp;&nbsp;&nbsp;options:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indent:&nbsp;&lt;mode&gt;<br>
```<br>
<br>
Режимы:<br>
<br>
*&nbsp;`from-marker`&nbsp;/&nbsp;`marker`&nbsp;/&nbsp;`auto`&nbsp;—&nbsp;выровнять&nbsp;`payload`&nbsp;по&nbsp;отступу&nbsp;маркера/символа<br>
&nbsp;&nbsp;(режим&nbsp;по&nbsp;умолчанию,&nbsp;если&nbsp;`options.indent`&nbsp;не&nbsp;указан);<br>
*&nbsp;`none`&nbsp;/&nbsp;`as-is`&nbsp;—&nbsp;оставить&nbsp;отступы&nbsp;`payload`&nbsp;&quot;как&nbsp;есть&quot;&nbsp;в&nbsp;соответствии&nbsp;с&nbsp;правилами&nbsp;yaml.<br>
<br>
Базовый&nbsp;отступ&nbsp;берётся:<br>
<br>
*&nbsp;для&nbsp;текстовых&nbsp;команд&nbsp;—&nbsp;из&nbsp;первой&nbsp;строки&nbsp;диапазона&nbsp;маркера;<br>
*&nbsp;для&nbsp;C++/Python-команд&nbsp;—&nbsp;из&nbsp;строки&nbsp;объявления&nbsp;класса/метода.<br>
<br>
Отступ&nbsp;добавляется&nbsp;только&nbsp;к&nbsp;**непустым**&nbsp;строкам&nbsp;`payload`.<br>
<br>
---<br>
<br>
##&nbsp;4.&nbsp;Файловые&nbsp;команды<br>
<br>
###&nbsp;4.1.&nbsp;`create_file`<br>
<br>
Создать&nbsp;или&nbsp;перезаписать&nbsp;файл:<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/hello.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;create_file<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#include&nbsp;&lt;iostream&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;main()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;std::cout&nbsp;&lt;&lt;&nbsp;&quot;Hello\n&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
```<br>
<br>
*&nbsp;`path`&nbsp;—&nbsp;целевой&nbsp;файл.<br>
*&nbsp;`payload`&nbsp;—&nbsp;содержимое&nbsp;файла&nbsp;(может&nbsp;быть&nbsp;пустым&nbsp;-&gt;&nbsp;пустой&nbsp;файл).<br>
<br>
###&nbsp;4.2.&nbsp;`delete_file`<br>
<br>
Удалить&nbsp;файл:<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/obsolete.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;delete_file<br>
```<br>
<br>
---<br>
<br>
##&nbsp;5.&nbsp;Текстовые&nbsp;команды<br>
<br>
Работают&nbsp;с&nbsp;произвольным&nbsp;текстом&nbsp;по&nbsp;маркеру.<br>
<br>
Обязательные&nbsp;поля&nbsp;операции:<br>
<br>
*&nbsp;`path`<br>
*&nbsp;`op:&nbsp;insert_after_text&nbsp;|&nbsp;insert_before_text&nbsp;|&nbsp;replace_text&nbsp;|&nbsp;delete_text`<br>
*&nbsp;`marker`<br>
<br>
Дополнительные:<br>
<br>
*&nbsp;`before`,&nbsp;`after`&nbsp;—&nbsp;опциональный&nbsp;контекст&nbsp;(указывают,&nbsp;что&nbsp;окружает&nbsp;маркер);<br>
*&nbsp;`payload`&nbsp;—&nbsp;обязателен&nbsp;для&nbsp;всех,&nbsp;кроме&nbsp;`delete_text`;<br>
*&nbsp;`comment`&nbsp;—&nbsp;опциональная&nbsp;человекочитаемая&nbsp;заметка&nbsp;к&nbsp;операции;<br>
*&nbsp;`options.indent`&nbsp;—&nbsp;опционально.<br>
<br>
###&nbsp;5.1.&nbsp;`replace_text`<br>
<br>
Заменить&nbsp;фрагмент&nbsp;по&nbsp;маркеру:<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_text<br>
&nbsp;&nbsp;&nbsp;&nbsp;marker:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;value()&nbsp;const;<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;value()&nbsp;const&nbsp;noexcept;<br>
```<br>
<br>
###&nbsp;5.2.&nbsp;`insert_after_text`<br>
<br>
Вставить&nbsp;текст&nbsp;сразу&nbsp;**после**&nbsp;маркера:<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;insert_after_text<br>
&nbsp;&nbsp;&nbsp;&nbsp;marker:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;Foo::init()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_stuff();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;Foo::log_state()&nbsp;const<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
```<br>
<br>
###&nbsp;5.3.&nbsp;`insert_before_text`<br>
<br>
Вставить&nbsp;текст&nbsp;**перед**&nbsp;маркером:<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;insert_before_text<br>
&nbsp;&nbsp;&nbsp;&nbsp;marker:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;run();<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;debug_run();<br>
```<br>
<br>
###&nbsp;5.4.&nbsp;`delete_text`<br>
<br>
Удалить&nbsp;фрагмент&nbsp;по&nbsp;маркеру:<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;delete_text<br>
&nbsp;&nbsp;&nbsp;&nbsp;marker:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#include&nbsp;&quot;debug.h&quot;<br>
```<br>
<br>
---<br>
<br>
##&nbsp;6.&nbsp;Команды&nbsp;для&nbsp;C++&nbsp;/&nbsp;Python-символов<br>
<br>
Работают&nbsp;с&nbsp;классами&nbsp;и&nbsp;методами,&nbsp;а&nbsp;не&nbsp;с&nbsp;произвольным&nbsp;текстом.<br>
<br>
Поддерживаемые&nbsp;команды:<br>
<br>
*&nbsp;`replace_cpp_class`<br>
*&nbsp;`replace_cpp_method`<br>
*&nbsp;`replace_py_class`<br>
*&nbsp;`replace_py_method`<br>
<br>
Общие&nbsp;поля:<br>
<br>
*&nbsp;`path`<br>
*&nbsp;`op`<br>
*&nbsp;`payload`&nbsp;—&nbsp;новый&nbsp;код&nbsp;класса/метода;<br>
*&nbsp;`comment`&nbsp;—&nbsp;опциональная&nbsp;человекочитаемая&nbsp;заметка&nbsp;к&nbsp;операции;<br>
*&nbsp;`options.indent`&nbsp;—&nbsp;режим&nbsp;отступов.<br>
<br>
Цель&nbsp;задаётся&nbsp;либо:<br>
<br>
*&nbsp;через&nbsp;`class`&nbsp;+&nbsp;`method`,<br>
*&nbsp;либо&nbsp;через&nbsp;`symbol`.<br>
<br>
###&nbsp;6.1.&nbsp;C++:&nbsp;`replace_cpp_class`<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_cpp_class<br>
&nbsp;&nbsp;&nbsp;&nbsp;class:&nbsp;Foo<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;Foo&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;value()&nbsp;const&nbsp;{&nbsp;return&nbsp;42;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
```<br>
<br>
###&nbsp;6.2.&nbsp;C++:&nbsp;`replace_cpp_method`<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_cpp_method<br>
&nbsp;&nbsp;&nbsp;&nbsp;class:&nbsp;Foo<br>
&nbsp;&nbsp;&nbsp;&nbsp;method:&nbsp;value<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;Foo::value()&nbsp;const<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;42;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
```<br>
<br>
или&nbsp;короткая&nbsp;форма:<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_cpp_method<br>
&nbsp;&nbsp;&nbsp;&nbsp;symbol:&nbsp;Foo::value<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;Foo::value()&nbsp;const<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;42;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
```<br>
<br>
###&nbsp;6.3.&nbsp;Python:&nbsp;`replace_py_class`<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.py<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_py_class<br>
&nbsp;&nbsp;&nbsp;&nbsp;class:&nbsp;Foo<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;Foo:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.x&nbsp;=&nbsp;2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;answer(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;42<br>
```<br>
<br>
###&nbsp;6.4.&nbsp;Python:&nbsp;`replace_py_method`<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.py<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_py_method<br>
&nbsp;&nbsp;&nbsp;&nbsp;class:&nbsp;Foo<br>
&nbsp;&nbsp;&nbsp;&nbsp;method:&nbsp;run<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;run(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;running...&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;100<br>
```<br>
<br>
или:<br>
<br>
```yaml<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.py<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_py_method<br>
&nbsp;&nbsp;&nbsp;&nbsp;symbol:&nbsp;Foo.run<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;run(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;running...&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;100<br>
```<br>
<br>
---<br>
<br>
##&nbsp;7.&nbsp;Пример&nbsp;цельного&nbsp;патча<br>
<br>
```yaml<br>
description:&nbsp;&quot;Обновить&nbsp;реализацию&nbsp;значения&nbsp;в&nbsp;C++&nbsp;и&nbsp;Python&quot;<br>
<br>
operations:<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.cpp<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_cpp_method<br>
&nbsp;&nbsp;&nbsp;&nbsp;comment:&nbsp;&quot;Обновляем&nbsp;реализацию&nbsp;Foo::value&nbsp;в&nbsp;C++&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;class:&nbsp;Foo<br>
&nbsp;&nbsp;&nbsp;&nbsp;method:&nbsp;value<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;Foo::value()&nbsp;const<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;42;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;-&nbsp;path:&nbsp;src/foo.py<br>
&nbsp;&nbsp;&nbsp;&nbsp;op:&nbsp;replace_py_method<br>
&nbsp;&nbsp;&nbsp;&nbsp;comment:&nbsp;&quot;Обновляем&nbsp;реализацию&nbsp;Foo.run&nbsp;в&nbsp;Python&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;class:&nbsp;Foo<br>
&nbsp;&nbsp;&nbsp;&nbsp;method:&nbsp;run<br>
&nbsp;&nbsp;&nbsp;&nbsp;payload:&nbsp;|-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;run(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;value:&quot;,&nbsp;self.value)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self.value<br>
```<br>
<!-- END SCAT CODE -->
</body>
</html>
